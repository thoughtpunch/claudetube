# Ralph Progress - claudetube

## Codebase Notes

Architecture (refactored v0.4.0):
```
src/claudetube/
├── models/          # Data models (VideoResult, VideoURL, VideoFile, VideoState)
├── config/          # Configuration (quality tiers, providers, defaults)
├── tools/           # External tool wrappers (yt_dlp, ffmpeg, whisper)
├── cache/           # Cache management (manager, scenes, storage)
├── operations/      # High-level ops (download, transcribe, extract_frames, playlist)
├── analysis/        # Analysis modules (linguistic, pause, vocabulary, visual)
├── parsing/         # URL parsing utilities
├── utils/           # Shared utilities (logging, formatting, system)
├── mcp_server.py    # MCP tool definitions
└── cli.py           # Command line interface
```

Cache location: `~/.claude/video_cache/{video_id}/`
Playlist cache: `~/.claude/video_cache/playlists/{playlist_id}/`

---

## Iteration Log

(Entries appended by ralph-beads.sh when running)

---
- 2026-02-01 14:38 | claudetube-i3x [P2] | Implement VideoMemory class
- 2026-02-01 14:43 | claudetube-j2j [P2] | Multi-pass analysis depths
- 2026-02-01 14:50 | claudetube-jzb [P3] | Cross-video knowledge graph for playlists
- 2026-02-01 14:56 | claudetube-pow [P3] | Support local embedding models
- 2026-02-01 14:58 | claudetube-bv5 [P3] | Track objects and concepts across scenes
- 2026-02-01 15:06 | claudetube-h5b [P3] | Cross-video knowledge graph
- 2026-02-01 15:14 | claudetube-175 [P3] | Interaction-driven cache enrichment
- 2026-02-01 15:24 | claudetube-9i5 [P3] | Implement ActiveVideoWatcher class
- 2026-02-01 15:31 | claudetube-awk [P3] | Implement attention priority modeling
- 2026-02-01 15:52 | claudetube-bst [P0] | Create Provider Base Module Structure
- 2026-02-01 15:56 | claudetube-gpx [P0] | Define Provider Protocols and Base Classes
- 2026-02-01 16:01 | claudetube-cqq [P0] | Define Result Types and Schemas
- 2026-02-01 16:09 | claudetube-p5o [P0] | Define Capability Enum and ProviderInfo
- 2026-02-01 16:14 | claudetube-2su [P0] | Create Provider Registry
- 2026-02-01 16:15 | claudetube-wnb.1 [P2] | Add yt-dlp AD Track Detection
- 2026-02-01 16:16 | claudetube-wnb.1 [P2] | Add yt-dlp AD Track Detection
- 2026-02-01 16:17 | claudetube-wnb.1 [P2] | Add yt-dlp AD Track Detection
- 2026-02-01 16:20 | claudetube-wnb.1 [P2] | Add yt-dlp AD Track Detection
- 2026-02-01 16:23 | claudetube-wnb.5 [P2] | Extend State Model for AD
- 2026-02-01 16:27 | claudetube-wnb.2 [P2] | Implement Scene Description Compiler
- 2026-02-01 16:34 | claudetube-did [P3] | Implement comprehension verification
- 2026-02-01 16:43 | claudetube-p0c [P0] | Create Configuration Loader for Providers
- 2026-02-01 16:50 | claudetube-a33 [P0] | Implement ClaudeCodeProvider
- 2026-02-01 16:55 | claudetube-hdt [P0] | Implement OpenAIProvider
- 2026-02-01 17:03 | claudetube-w1c [P0] | Implement GoogleProvider (Gemini)
- 2026-02-01 17:56 | claudetube-wnb.3 [P2] | Add Provider Integration for AD Generation
- 2026-02-01 18:05 | claudetube-cm3 [P0] | Refactor TranscribeOperation
- 2026-02-01 18:11 | claudetube-u2a [P0] | Refactor VisualTranscriptOperation
- 2026-02-01 18:21 | claudetube-29f [P0] | Refactor EntityExtractionOperation
- 2026-02-01 18:30 | claudetube-z4b [P1] | Refactor PersonTrackingOperation
- 2026-02-01 18:41 | claudetube-os2 [P0] | Create OperationFactory
- 2026-02-01 18:46 | claudetube-wnb.4 [P2] | Add AD MCP Tools
- 2026-02-01 19:47 | claudetube-wnb.4 [P2] | Add AD MCP Tools
- 2026-02-01 20:03 | claudetube-bdj [P3] | Add /yt:watch command for active viewing
- 2026-02-01 20:19 | claudetube-i4c [P3] | Wire attention priority modeling into ActiveVideoWatcher
- 2026-02-01 21:39 | claudetube-mc7 [P2] | Fix 7 failing config loader tests
- 2026-02-01 21:44 | claudetube-05a [P3] | Add example YAML provider config files
- 2026-02-01 21:48 | claudetube-cmg [P2] | Add LiteLLM integration for generic reasoning
- 2026-02-01 21:57 | claudetube-0sn [P2] | Add structured output schemas (providers/schemas.py)
- 2026-02-01 22:07 | claudetube-txy [P2] | Implement capability-driven entity extraction (PRD Phase 8)
- 2026-02-01 22:16 | claudetube-chb [P3] | Add CLI validate-config command
- 2026-02-01 22:21 | claudetube-dbc [P3] | Add cost-based routing to ProviderRouter
- 2026-02-01 22:29 | claudetube-8ju [P3] | Add VideoAnalyzer support to EntityExtractionOperation
- 2026-02-01 22:37 | claudetube-afx [P3] | Add Ollama server health check to is_available()
- 2026-02-01 22:41 | claudetube-gx1 [P3] | Add embedder-based semantic query for search
- 2026-02-01 23:08 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:09 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:10 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:11 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:12 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:13 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:14 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:15 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:16 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:17 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:18 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:19 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:20 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:21 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-01 23:22 | claudetube-9lb [P4] | Add streaming transcription support
- 2026-02-02 07:44 | claudetube-br9 [P2] | Complete v1.0.0rc1 dependency audit and close claudetube-w30
- 2026-02-02 08:12 | claudetube-ipn [P3] | Add /yt:deep and /yt:focus slash commands
- 2026-02-02 08:19 | claudetube-260 [P3] | Add integration tests for real provider API calls
- 2026-02-02 08:26 | claudetube-cnv [P3] | Add tests for operations/download.py
- 2026-02-02 08:29 | claudetube-eqc [P3] | Add tests for operations/transcribe.py
- 2026-02-02 08:33 | claudetube-mku [P3] | Add tests for operations/processor.py URL-based processing
- 2026-02-02 08:38 | claudetube-bzz [P4] | Wire embedding-based attention scoring into ActiveVideoWatcher
- 2026-02-02 08:47 | claudetube-cst [P4] | Add multilingual support for audio descriptions
- 2026-02-02 16:34 | claudetube-5vi [P3] | Integrate bgutil-ytdlp-pot-provider plugin
- 2026-02-02 16:43 | claudetube-6m7 [P3] | Add YouTube cookie management to config
- 2026-02-02 16:49 | claudetube-il9 [P3] | Add deno as recommended prerequisite and verify in install.sh
- 2026-02-02 16:54 | claudetube-e65 [P4] | SABR protocol documentation and troubleshooting guide
- 2026-02-02 16:58 | claudetube-4ds [P4] | Add PO token auto-refresh and health checks
- 2026-02-02 17:38 | claudetube-2a6.1 [P1] | Create VideoPath Pydantic model + domain sanitization
- 2026-02-02 17:42 | claudetube-2a6.2 [P1] | Create URL query parameter extraction + timestamp parsing
- 2026-02-02 17:45 | claudetube-2a6.3 [P1] | Add channel/playlist named captures to provider patterns
- 2026-02-02 17:50 | claudetube-2a6.4 [P1] | Integrate VideoPath into VideoURL + VideoState
- 2026-02-02 18:00 | claudetube-wu0.1 [P1] | Create DB connection + migration infrastructure
- 2026-02-02 18:08 | claudetube-wu0.2 [P1] | Create initial schema DDL (001_initial.sql)
- 2026-02-02 18:14 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:15 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:15 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:16 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:16 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:16 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:16 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:16 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:16 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:17 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:17 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:17 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:17 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:17 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:17 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:17 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:18 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:18 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:18 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:18 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:18 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:18 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:19 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:19 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:19 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:19 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:19 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:19 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:20 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:20 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:20 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:20 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:20 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:20 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:21 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:21 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:21 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:21 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:21 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:21 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:22 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:22 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:22 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:22 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:22 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:22 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:23 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:23 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:23 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:23 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:23 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:23 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:24 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:24 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:24 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:24 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:24 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:24 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:25 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:25 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:25 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:25 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:25 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:25 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:26 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:26 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:26 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:26 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:26 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:26 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:27 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:27 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:27 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:27 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:27 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:27 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:28 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:28 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:28 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:28 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:28 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:29 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:29 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:29 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:29 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:29 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:29 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:29 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:30 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:30 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:30 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:30 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 18:30 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 19:23 | claudetube-wu0.3 [P1] | Create sqlite-vec integration module
- 2026-02-02 19:30 | claudetube-wu0.4 [P1] | Create core repositories: videos, audio_tracks, transcriptions
- 2026-02-02 19:36 | claudetube-wu0.5 [P1] | Create scene + frame repositories
- 2026-02-02 19:42 | claudetube-wu0.6 [P1] | Create analysis repositories: visual, technical, audio desc, narrative, code evolution
- 2026-02-02 19:48 | claudetube-wu0.7 [P1] | Create entity, Q&A, observation repositories
- 2026-02-02 20:01 | claudetube-1id.1 [P1] | Create db/sync.py with progressive enrichment
- 2026-02-02 20:08 | claudetube-1id.2 [P1] | Add dual-write to storage, processor, and transcriber
- 2026-02-02 20:20 | claudetube-1id.3 [P1] | Add dual-write to scene, frame, and analysis paths
- 2026-02-02 20:34 | claudetube-1id.5 [P1] | Add auto-embedding in sqlite-vec at write time
- 2026-02-02 20:44 | claudetube-kve.1 [P1] | Create auto-import module for existing JSON caches
- 2026-02-02 20:53 | claudetube-kve.2 [P1] | Replace file-scanning reads with SQL/FTS queries
- 2026-02-02 21:03 | claudetube-kve.3 [P1] | Unified FTS5 + sqlite-vec search across all content
- 2026-02-02 21:16 | claudetube-ba1.1 [P1] | Activate hierarchical paths in CacheManager + processor
- 2026-02-02 21:27 | claudetube-ba1.2 [P1] | Implement progressive directory enrichment (move on metadata improve)
- 2026-02-02 21:34 | claudetube-ba1.3 [P1] | Create migration CLI for flat-to-hierarchical conversion
- 2026-02-02 21:41 | claudetube-7s4 [P4] | Add translation support to DeepgramProvider
- 2026-02-03 07:57 | claudetube-nrf [P1] | Use yt-dlp Python API instead of subprocess
- 2026-02-03 08:08 | claudetube-3ri [P1] | Add structured output parsing for yt-dlp subprocess
- 2026-02-03 08:28 | claudetube-d6q [P1] | Create typed exception hierarchy for download errors
- 2026-02-03 08:39 | claudetube-r7o [P1] | Surface full yt-dlp error codes and diagnostic info
- 2026-02-03 08:44 | claudetube-dqz [P2] | Add download progress tracking with callbacks
- 2026-02-03 09:05 | claudetube-unf [P2] | Define yt-dlp output template matching cache structure
- 2026-02-03 09:12 | claudetube-vzb [P2] | Implement batch playlist download using yt-dlp templates
- 2026-02-03 09:17 | claudetube-sws [P3] | Configure parallel output paths for subtitles and thumbnails
- 2026-02-03 14:15 | claudetube-a7fm [P1] | Create integration test: test_mcp_tools_e2e.py
- 2026-02-03 14:31 | claudetube-a7fm [P1] | Create integration test: test_mcp_tools_e2e.py
- 2026-02-03 14:34 | claudetube-jal [P1] | claude-code provider returns empty/malformed responses for vision tasks
Task completed: Tue Feb  3 14:44:25 CST 2026
- 2026-02-03 15:26 | claudetube-q241 [P0] | CRITICAL: All tools must use hierarchical paths - flat paths are deprecated
